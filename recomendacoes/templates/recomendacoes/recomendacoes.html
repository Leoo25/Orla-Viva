{% extends 'base.html' %}
{% block titulo %}Recomendações{% endblock %}


{% block conteudo %}
<section class="container mx-auto px-4 py-8 bg-gray-50">
  <h2 class="text-3xl font-bold text-gray-800 mb-8 border-l-4 border-blue-600 pl-4">Nossas Recomendações</h2>

  {% for categoria in categorias_recomendacao %}
  <div class="mb-12">
    
    <div class="mb-4">
      <h3 class="text-2xl font-bold text-gray-700">{{ categoria.nome }}</h3>
      <p class="text-sm text-gray-500">Deslize para o lado para ver mais</p>
    </div>

    <div class="relative group">
      
      <button class="absolute left-0 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-3 shadow-xl z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 border border-gray-200 hidden md:block"
              onclick="scrollCarousel('carousel-{{ categoria.pk }}', -320)">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
        </svg>
      </button>

      <div id="carousel-{{ categoria.pk }}" class="flex overflow-x-auto scroll-smooth snap-x snap-mandatory pb-6 hide-scrollbar gap-6 px-2">
        
        {% for rec in categoria.recomendacao_set.all %} 
        <div class="snap-center shrink-0 w-72 sm:w-80"> 
          <div class="relative h-96 w-full overflow-hidden rounded-2xl shadow-lg hover:shadow-2xl transition-all duration-300 group/card">
            
            <div class="absolute inset-0 h-full w-full">
              {% if rec.imagem %}
                <img src="{{ rec.imagem.url }}" alt="{{ rec.nome }}" class="h-full w-full object-cover transition-transform duration-700 group-hover/card:scale-110" />
              {% else %}
                <div class="h-full w-full bg-gray-800 flex items-center justify-center text-gray-500 font-medium">
                    Sem Foto
                </div>
              {% endif %}
            </div>

            <div class="absolute inset-0 bg-gradient-to-t from-black/95 via-black/50 to-transparent"></div>
            
            <div class="relative flex h-full flex-col justify-end p-5 text-white">
              
              <div class="absolute top-4 right-4 flex flex-col gap-2 items-end">
                {% if rec.avaliacao %}
                <span class="rounded-full bg-yellow-400 px-2 py-1 text-xs font-black text-black shadow-lg">
                  {{ rec.get_avaliacao_display }}
                </span>
                {% endif %}
                {% if rec.faixa_preco %}
                <span class="rounded-full bg-black/60 px-2 py-1 text-xs font-bold border border-white/20 backdrop-blur-sm">
                  {{ rec.get_faixa_preco_display }}
                </span>
                {% endif %}
              </div>
              
              <h4 class="text-2xl font-bold leading-tight mb-1 shadow-black drop-shadow-md">{{ rec.nome }}</h4>
              
              {% if rec.endereco_texto %}
              <p class="text-xs text-gray-300 flex items-start gap-1 mb-3 line-clamp-1">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 shrink-0 text-blue-400" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd" /></svg>
                {{ rec.endereco_texto }}
              </p>
              {% endif %}

              {% if rec.redeSocial_url %}
              <a href="{{ rec.redeSocial_url }}" target="_blank" class="mt-2 w-full rounded-xl bg-white/10 hover:bg-white/20 border border-white/30 backdrop-blur-md py-3 text-center text-sm font-bold text-white transition-all hover:scale-105 active:scale-95">
                Ver Local
              </a>
              {% endif %}
            </div>
          </div>
        </div>
        {% empty %}
          <div class="w-full text-center py-10 bg-white rounded-lg border border-dashed border-gray-300">
            <p class="text-gray-500">Nenhuma recomendação cadastrada aqui ainda.</p>
          </div>
        {% endfor %}

      </div>
      
      <button class="absolute right-0 top-1/2 -translate-y-1/2 bg-white/90 hover:bg-white rounded-full p-3 shadow-xl z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 border border-gray-200 hidden md:block"
              onclick="scrollCarousel('carousel-{{ categoria.pk }}', 320)">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
        </svg>
      </button>
      
    </div>
  </div>
  {% endfor %}

</section>

<style>
  .hide-scrollbar::-webkit-scrollbar {
    display: none;
  }
  .hide-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>

<script>
  function scrollCarousel(id, amount) {
    const container = document.getElementById(id);
    if (container) {
      container.scrollBy({ left: amount, behavior: 'smooth' });
    }
  }
</script>


{%endblock%}
    